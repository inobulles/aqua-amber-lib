// interface with joysticks

import lib/device.a

class Joystick {
	var id;
	Device->var device;
	
	func construct(var id) {
		self.id = id;
		self.device = new(Device).construct("joystick");
		
		return self;
	}
	
	func name return self.device.send(0x6E, self.id);
	func raw_axis(var axis) return ?self.device.send(0x61, self.id, axis);
	func button(var button) return ?self.device.send(0x62, self.id, button);
	
	func rumble(var strength, var seconds, var period, var direction) {
		return ?self.device.send(0x68, self.id, strength, seconds, period, direction);
	}
	
	func axis_deadzone(var axis, var deadzone) {
		var value = self.raw_axis(axis);
		if (value < -deadzone or value > deadzone) return value;
		return 0;
	}
	
	func axis(var axis) {
		return self.axis_deadzone(axis, 100000);
	}
	
	// static functions
	
	func count {
		return ?Device.send("joystick", 0x63);
	}
}
